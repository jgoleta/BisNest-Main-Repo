{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Employee | BisNest</title>
  <link rel="stylesheet" href="{% static 'css/centralStyle.css' %}">
  <link rel="stylesheet" href="{% static 'css/employeeStyle.css' %}">
  <link rel="stylesheet" href="{% static 'css/centralDarkStyle.css' %}">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="{% static 'js/darkMode.js' %}" defer></script>
  <script src="{% static 'js/sidebar.js' %}" defer></script>
  <script src="{% static 'js/employee.js' %}" defer></script>
</head>

<body>

  {% include 'sidebar.html' %}

  <main class="main-content">

    {% include 'header.html' with page="Employee Management" %}

    <div class="container">
      <div class="search-bar">
        <input type="text" id="searchInput" placeholder="Search Employee Name:" onkeyup="searchEmployee()">
        <div class="button-container">
          <button class="toggle-form-button" onclick="toggleForm()">+ New</button>
        </div>
      </div>

      <div class="employee-form-container" id="formContainer">
        <h2 class="form-title" id="formTitle">Employee Information</h2>
        <form class="employee-form" method="POST">
          {% csrf_token %}
          <input type="hidden" name="edit_id" id="edit_id">
          <div class="form-row">
            <div class="form-group">
              <label for="{{ form.name.id_for_label }}"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960"
                  fill="#87CEEB">
                  <path
                    d="M480-480q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47ZM160-160v-112q0-34 17.5-62.5T224-378q62-31 126-46.5T480-440q66 0 130 15.5T736-378q29 15 46.5 43.5T800-272v112H160Zm80-80h480v-32q0-11-5.5-20T700-306q-54-27-109-40.5T480-360q-56 0-111 13.5T260-306q-9 5-14.5 14t-5.5 20v32Zm240-320q33 0 56.5-23.5T560-640q0-33-23.5-56.5T480-720q-33 0-56.5 23.5T400-640q0 33 23.5 56.5T480-560Zm0-80Zm0 400Z" />
                </svg> Employee Name:</label>
              {{ form.name }}
            </div>
            <div class="form-group">
              <label for="{{ form.position.id_for_label }}"><svg xmlns="http://www.w3.org/2000/svg" height="24px"
                  viewBox="0 -960 960 960" width="24px" fill="#CF9FFF">
                  <path
                    d="M600-160H320q-33 0-56.5-23.5T240-240v-440h80v440h280v80ZM460-720q-33 0-56.5-23.5T380-800q0-33 23.5-56.5T460-880q33 0 56.5 23.5T540-800q0 33-23.5 56.5T460-720ZM640-80v-200H440q-33 0-56.5-23.5T360-360v-220q0-42 29-71t71-29q42 0 71 29t29 71v180h80q33 0 56.5 23.5T720-320v240h-80Z" />
                </svg> Position:</label>
              {{ form.position }}
            </div>
            <div class="form-group">
              <label for="{{ form.schedule.id_for_label }}"><svg xmlns="http://www.w3.org/2000/svg" height="24px"
                  viewBox="0 -960 960 960" width="24px" fill="#FFA500">
                  <path
                    d="m612-292 56-56-148-148v-184h-80v216l172 172ZM480-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-400Zm0 320q133 0 226.5-93.5T800-480q0-133-93.5-226.5T480-800q-133 0-226.5 93.5T160-480q0 133 93.5 226.5T480-160Z" />
                </svg> Schedule:</label>
              {{ form.schedule }}
            </div>
            <div class="form-group">
              <label for="{{ form.salary.id_for_label }}"><svg xmlns="http://www.w3.org/2000/svg" height="24px"
                  viewBox="0 -960 960 960" width="24px" fill="#00FF00">
                  <path
                    d="M336-120q-91 0-153.5-62.5T120-336q0-38 13-74t37-65l142-171-97-194h530l-97 194 142 171q24 29 37 65t13 74q0 91-63 153.5T624-120H336Zm144-200q-33 0-56.5-23.5T400-400q0-33 23.5-56.5T480-480q33 0 56.5 23.5T560-400q0 33-23.5 56.5T480-320Zm-95-360h190l40-80H345l40 80Zm-49 480h288q57 0 96.5-39.5T760-336q0-24-8.5-46.5T728-423L581-600H380L232-424q-15 18-23.5 41t-8.5 47q0 57 39.5 96.5T336-200Z" />
                </svg> Salary:</label>
              {{ form.salary }}
            </div>
          </div>
          <div class="submit-wrapper">
            <button type="submit" class="submit-button">Submit</button>
            <button type="button" class="cancel-button">Cancel</button>
          </div>
        </form>
      </div>
      <div class="modal-overlay" id="modalOverlay" style="display: none;"></div>
      <div class="table-wrapper">
        <table class="table">
          <thead>
            <tr>
              <th>Employee ID</th>
              <th>Employee Name <button id="employeeNameSortBtn" class="sort-btn" title="Sort by Name"><i class="fas fa-sort"></i></button></th>
              <th>Position</th>
              <th>Schedule</th>
              <th>Daily Salary</th>
              <th>Join Date <button id="employeeJoinDateSortBtn" class="sort-btn" title="Sort by Name"><i class="fas fa-sort"></i></button></th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>

            {% for emp in employees %}
            <tr>
              <td>{{ emp.id }}</td>
              <td>{{ emp.name }}</td>
              <td>{{ emp.position }}</td>
              <td>{{ emp.schedule }}</td>
              <td>{{ emp.salary }}</td>
              <td>{{ emp.join_date}}</td>
              <td>
                <button type="button" class="edit-button" data-id="{{ emp.id }}" data-name="{{ emp.name }}"
                  data-position="{{ emp.position }}" data-schedule="{{ emp.schedule }}" data-salary="{{ emp.salary }}"
                  title="Edit employee" aria-label="Edit employee" style="margin-right:8px;">

                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"
                    aria-hidden="true" focusable="false">
                    <path d="M3 21v-3.75L14.81 5.44a2 2 0 0 1 2.83 0l0.92 0.92a2 2 0 0 1 0 2.83L6.75 21H3z"
                      stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" />
                    <path d="M20.71 7.04a1 1 0 0 0 0-1.41l-2.34-2.34a1 1 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"
                      stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" />
                  </svg>
                </button>
                <form action="{% url 'delete_employee' emp.id %}" method="post" style="display:inline;">
                  {% csrf_token %}
                  <button type="submit" class="delete-button"><svg xmlns="http://www.w3.org/2000/svg" width="16"
                      height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">
                      <path
                        d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z" />
                      <path
                        d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z" />
                    </svg></button>
                </form>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </main>

</body>

</html>
