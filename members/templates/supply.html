{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BisNest Dashboard</title>
  <link rel="stylesheet" href="{% static 'css/centralStyle.css' %}">
  <link rel="stylesheet" href="{% static 'css/supplyStyle.css' %}">
  <link rel="stylesheet" href="{% static 'css/centralDarkStyle.css' %}">
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=dashboard" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="{% static 'js/darkMode.js' %}" defer></script>
  <script src="{% static 'js/sidebar.js' %}" defer></script>
  <script src="{% static 'js/supply.js' %}" defer></script>

</head>

<body>

  {% include 'sidebar.html' %}

  <main class="main-content">

    {% include 'header.html' with page="Customer Management" %}

    <div class="container">
      <div class="search-bar">
        <input type="text" id="searchInput" placeholder="Search Supply:" onkeyup="searchSupply()">
        <div class="button-container">
          <button class="toggle-form-button" onclick="toggleForm()">+ New</button>
        </div>
      </div>

      <div class="modal-overlay" id="modalOverlay" style="display:none;"></div>
      <div class="supply-form-container" id="formContainer">
        <h2 class="form-title" id="formTitle">Supply Details</h2>
        <form class="supply-form" method="POST">
          {% csrf_token %}
          <div class="form-row">
            <div class="form-group">
              <label for="{{ form.supplier.id_for_label }}">Supplier</label>
              {{ form.supplier }}
            </div>
            <div class="form-group">
              <label for="{{ form.product.id_for_label }}">Product Name</label>
              {{ form.product }}
            </div>
            <div class="form-group">
              <label for="{{ form.quantity.id_for_label }}">Quantity</label>
              {{ form.quantity }}
            </div>
            <div class="form-group">
              <label for="{{ form.date.id_for_label }}">Delivery Date</label>
              {{ form.date }}
            </div>
            <div class="form-group">
              <label for="{{ form.price.id_for_label }}">Total Price (₱)</label>
              {{ form.price }}
            </div>
          </div>

          <div class="submit-wrapper">
            <button type="submit" class="submit-button">Submit</button>
            <button type="button" class="cancel-button" onclick="toggleForm()">Cancel</button>
          </div>
        </form>

      </div>

      <div class="supply-table-container">
        <div class="table-wrapper">
          <table class="table" id="supply-table">
            <thead>
              <tr>
                <th>Supply ID</th>
                <th>Supplier</th>
                <th>Product Name</th>
                <th>Quantity</th>
                <th>Date</th>
                <th>Price</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody>
              {% for s in supplies %}
              <tr>
                <td>{{ s.supply_id }}</td>
                <td>{{ s.supplier }}</td>
                <td>{{ s.product.name }}</td>
                <td>{{ s.quantity }}</td>
                <td>{{ s.date }}</td>
                <td>₱{{ s.price }}</td>
                <td>
                  <button type="button" class="edit-button" data-supply_id="{{ s.supply_id }}" data-supplier="{{ s.supplier }}"
                    data-product="{{ s.product }}" data-quantity="{{ s.quantity }}" data-date="{{ s.date }}" data-price="{{ s.price }}" title="Edit supply"
                    aria-label="Edit supply" style="margin-right:8px;">
                    <svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 -960 960 960" width="20px"
                      fill="#FFFFFF">
                      <path
                        d="M120-120v-170l528-527q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L290-120H120Zm584-528 56-56-56-56-56 56 56 56Z" />
                    </svg>
                  </button>

                  {% if s.supply_id %}
                  <form action="{% url 'delete_supply' s.supply_id %}" method="post" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit" class="delete-button" title="Delete supply">
                      <svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 -960 960 960" width="20px"
                        fill="#FFFFFF">
                        <path
                          d="M312-144q-29.7 0-50.85-21.15Q240-186.3 240-216v-480h-48v-72h192v-48h192v48h192v72h-48v479.57Q720-186 698.85-165T648-144H312Zm72-144h72v-336h-72v336Zm120 0h72v-336h-72v336Z" />
                      </svg>
                    </button>
                  </form>
                  {% endif %}
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
        <div class="pagination-container" id="supply-pagination" aria-label="Customer table pagination"></div>
      </div>
    </div>
  </main>

</body>

</html>