<!DOCTYPE html>
<html lang="en">

<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sales Report</title>
  <style>
    @import url("./palette.css");

    <!DOCTYPE html>
    <html lang="en">

    <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>Sales Report</title>
      <style>
        @import url("./palette.css");

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body { font-family: 'Sen', sans-serif; background: #fff; color: #111; }

        .navigation-div { max-width: 1200px; margin: auto; height: 90px; display: flex; align-items: center; justify-content: space-between; }
        .nav-logo { height: 60px; border-radius: 50%; background-color: #fff; padding: 5px; }
        .sidebar ul li { padding: 5px 30px; }
        .sidebar ul li a { color: #111; text-decoration: none; display: flex; align-items: center; gap: 10px; }
        .sidebar img { width: 30px; }

        .form button:hover { background-color: #000; color: #fff; }

        h1 { font-size: 35px; margin-bottom: 20px; text-align: center; color: #111; }

        .form { display: flex; flex-wrap: wrap; gap: 12px; margin-bottom: 24px; }
        .form input, .form select { padding: 10px; font-size: 14px; border-radius: 6px; border: 1px solid #bbb; flex: 1; background: #fff; color: #111; }
        .form input:hover, .form select:hover { border-color: #000; box-shadow: 0 0 5px rgba(211,84,0,0.5); }
        .form button { background-color: #111; color: #fff; padding: 10px 20px; border-radius: 10px; cursor: pointer; font-weight: bold; }

        .table { width: 100%; border-collapse: collapse; border-radius: 10px; overflow: hidden; background-color: #fff; margin-top: 20px; box-shadow: 0 6px 18px rgba(0,0,0,0.07); color: #111; }
        .table th, .table td { padding: 12px; text-align: center; border-bottom: 1px solid #e0e0e0; }
        .table th { background-color: #000; color: #fff; }
        .delete-button { background-color: #fff; color: #111; padding: 6px 12px; border-radius: 6px; font-weight: bold; cursor: pointer; }
        .delete-button:hover { background-color: #111; color: #fff; }

        .notification { position: fixed; top: 20px; right: 20px; padding: 15px 25px; background-color: #2ecc71; color: #fff; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); z-index: 1000; opacity: 0; transition: opacity .5s; }
        .notification.show { opacity: 1; }

        body, html { height: 100%; overflow: hidden; }
        .burger { width: 30px; height: 24px; display: flex; flex-direction: column; justify-content: space-between; position: fixed; top: 35px; left: 50px; z-index: 2001; background: none; border: none; }
        .burger span { height: 4px; width: 100%; background: #111; border-radius: 2px; }

        .sidebar { position: fixed; top: 90px; left: -300px; width: 300px; height: calc(100% - 90px); background-color: #f5f5f5; overflow-y: auto; transition: left .3s ease; z-index: 2000; }
        #sidebarToggle:checked ~ .sidebar { left: 0; }
        .overlay { display: none; position: fixed; top: 90px; left: 0; width: 100%; height: calc(100% - 90px); background: rgba(0,0,0,0.5); z-index:1500; visibility:hidden; }
        #sidebarToggle:checked ~ .overlay { display:block; visibility:visible; }
      </style>
    </head>

    <body>
      <input type="checkbox" id="sidebarToggle" style="display:none">
      <label for="sidebarToggle" class="burger"><span></span><span></span><span></span></label>
      <label for="sidebarToggle" class="overlay"></label>

      <nav class="navigation-top">
        <div class="navigation-div">
          <img src="https://i.ibb.co/60c2V5M5/485022833-1021832163206590-2049955099638617889-n.png" class="nav-logo" alt="Logo">
          <ul>
            <li><a href="{% url 'webpage12' %}">About</a></li>
            <li><a href="#contact">Contact</a></li>
          </ul>
          <a class="btn-signout" href="{% url 'webpage1' %}">Sign Out</a>
        </div>
      </nav>

      <nav class="sidebar">
        <ul>
          <li><a href="{% url 'webpage3' %}">Home</a></li>
          <li><a href="{% url 'webpage2' %}">Employee</a></li>
          <li><a href="{% url 'webpage7' %}">Customer</a></li>
          <li><a href="{% url 'webpage8' %}">Product</a></li>
          <li><a href="{% url 'webpage5' %}">Order</a></li>
          <li><a href="{% url 'webpage4' %}">Payment</a></li>
          <li><a href="{% url 'webpage9' %}">Delivery</a></li>
          <li><a href="{% url 'webpage11' %}">Supply</a></li>
          <li><a href="{% url 'webpage10' %}">Sales Report</a></li>
        </ul>
      </nav>

      <main class="main-content" style="padding-top:40px;">
        <section class="sales-container">
          <h1>Sales Report</h1>
          <form method="POST" class="form">
            {% csrf_token %}
            {{ form.as_p }}
            <button type="submit" class="action-button">Submit</button>
          </form>

          <table class="table">
            <thead>
              <tr>
                <th>Date</th>
                <th>Product Name</th>
                <th>Kilos Sold</th>
                <th>Price (Kg)</th>
                <th>Total (₱)</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody class="table-body">
              {% for sale in sales %}
              <tr>
                <td>{{ sale.date }}</td>
                <td>{{ sale.product_name }}</td>
                <td>{{ sale.kilos_sold }} kg</td>
                <td>₱{{ sale.price_per_kilo }}</td>
                <td class="row-total">₱{{ sale.total }}</td>
                <td>
                  <form method="POST" action="{% url 'delete_sale' sale.id %}" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit" class="delete-button">Delete</button>
                  </form>
                </td>
              </tr>
              {% endfor %}
            </tbody>
            <tfoot>
              <tr>
                <td colspan="4" style="text-align:right; font-weight:bold;">Grand Total:</td>
                <td id="grandTotal">₱0.00</td>
                <td></td>
              </tr>
            </tfoot>
          </table>
        </section>
      </main>

      <div class="notification" id="notification"></div>

      <script>
        // Recalculate grand total from server-rendered rows (works for both server and client adds)
        function updateGrandTotalFromRows() {
          var total = 0;
          var rows = document.querySelectorAll('.row-total');
          for (var i = 0; i < rows.length; i++) {
            var cell = rows[i];
            var v = parseFloat(cell.textContent.replace(/[₱,]/g, '')) || 0;
            total += v;
          }
          document.getElementById('grandTotal').textContent = '₱' + total.toFixed(2);
        }
        window.addEventListener('load', updateGrandTotalFromRows);
      </script>

    </body>
    </html>
    </body>
    </html>
          xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M16 13v-2H7V8l-5 4 5 4v-3zM20 3h-8v2h8v14h-8v2h8a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2z" />
        </svg>Sign Out</a>
  </main>
  <script>
    window.addEventListener('load', () => {
      let total = 0;
      document.querySelectorAll(".row-total").forEach(cell => {
        total += parseFloat(cell.textContent.replace(/[₱,]/g, '')) || 0;
      });
      document.getElementById("grandTotal").textContent = `₱${total.toFixed(2)}`;
    });
  </script>
</body>

</html>