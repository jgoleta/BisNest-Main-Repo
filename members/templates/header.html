{% load static %}
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Merriweather:wght@400;700&family=Roboto:wght@400;500;700&display=swap"
    rel="stylesheet">
<link rel="stylesheet" href="{% static 'css/headerStyle.css' %}">
<script src="{% static 'js/header.js' %}" defer></script>
<script src="{% static 'js/darkMode.js' %}" defer></script>
<script src="{% static 'js/modal.js' %}" defer></script>

<header class="app-header">
    <div class="header-left">
        <h1 class="header-title">{{ page }}</h1>
    </div>
    <div class="header-right">
        <div class="notification-dropdown" id="notificationDropdown">
            <button class="notification-button" id="notificationButton" aria-haspopup="true" aria-expanded="false"
                aria-controls="notificationMenu" title="Stock alerts">
                <span class="notification-icon" aria-hidden="true">
                    <svg xmlns="http://www.w3.org/2000/svg" height="22px" viewBox="0 -960 960 960" width="22px"
                        fill="currentColor">
                        <path
                            d="M480-80q-33 0-56.5-23.5T400-160h160q0 33-23.5 56.5T480-80Zm240-200v-240q0-99-63-173t-157-90v-37q0-17-11.5-28.5T460-860q-17 0-28.5 11.5T420-820v37q-94 16-157 90t-63 173v240l-60 60v20h640v-20l-60-60Z" />
                    </svg>
                </span>
                <span class="notification-badge" id="notificationCount" hidden>0</span>
            </button>
            <div class="notification-menu" id="notificationMenu" role="menu" aria-labelledby="notificationButton" hidden>
                <div class="notification-menu-header">
                    <span>Notifications</span>
                </div>
                <div class="notification-menu-body" id="notificationList">
                    <p class="notification-empty">No stock alerts</p>
                </div>
            </div>
        </div>

        <!-- User Dropdown -->
        <div class="user-dropdown" id="userDropdown">
            <button class="user-button" id="userButton" aria-haspopup="true" aria-expanded="false"
                aria-controls="userMenu">
                <span class="user-avatar" aria-hidden="true">ðŸ‘¤</span>
                <span class="user-name">{% if user.is_authenticated %}
                {{ user.first_name|default:user.username|default:"User" }}
            {% else %}
                Guest
            {% endif %}</span>
                <span class="caret">â–¾</span>
            </button>

            <div class="user-menu" id="userMenu" role="menu" aria-labelledby="userButton" hidden>
                <div class="user-info" role="none">
                    <div class="user-info-name">{% if user.is_authenticated %}
                    {{ user.first_name|default:user.username|default:"User" }}
                {% else %}
                    Guest
                {% endif %}</div>
                    <div class="user-info-email">{% if user.is_authenticated %}
                    {{ user.email }}
                {% else %}
                    Not signed in
                {% endif %}</div>
                </div>

                <button class="menu-item" id="profileBtn" role="menuitem" onclick="location.href='{% url 'profile' %}'">
                    <span><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                            fill="currentColor">
                            <path
                                d="M480-480q-66 0-113-47t-47-113q0-66 47-113t113-47q66 0 113 47t47 113q0 66-47 113t-113 47ZM160-160v-112q0-34 17.5-62.5T224-378q62-31 126-46.5T480-440q66 0 130 15.5T736-378q29 15 46.5 43.5T800-272v112H160Z" />
                        </svg></span>
                    Profile
                </button>
                <button class="menu-item" role="menuitem" onclick="location.href='{% url 'admin_settings' %}';">
                    <span><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                            fill="currentColor">
                            <path
                                d="M680-80q-83 0-141.5-58.5T480-280q0-83 58.5-141.5T680-480q83 0 141.5 58.5T880-280q0 83-58.5 141.5T680-80Zm-200 0q-139-35-229.5-159.5T160-516v-244l320-120 320 120v227q-26-13-58.5-20t-61.5-7q-116 0-198 82t-82 198q0 62 23.5 112T483-81q-1 0-1.5.5t-1.5.5Zm200-200q25 0 42.5-17.5T740-340q0-25-17.5-42.5T680-400q-25 0-42.5 17.5T620-340q0 25 17.5 42.5T680-280Zm0 120q31 0 57-14.5t42-38.5q-22-13-47-20t-52-7q-27 0-52 7t-47 20q16 24 42 38.5t57 14.5Z" />
                        </svg></span>
                    Admin Settings
                </button>
                <button class="menu-item" role="menuitem" onclick="location.href='{% url 'feedback' %}';">
                    <span><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                            fill="currentColor">
                            <path d="m233-120 93-304L80-600h304l96-320 96 320h304L634-424l93 304-247-188-247 188Z" />
                        </svg></span>
                    Feedback
                </button>
                <div class="menu-item theme-switch-container" role="menuitem">
                    <span>
                        <svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 -960 960 960" width="20px"
                            fill="currentColor" class="theme-icon theme-icon-moon">
                            <path
                                d="M480-120q-150 0-255-105T120-480q0-150 105-255t255-105q14 0 27.5 1t26.5 3q-41 29-65.5 75.5T444-660q0 90 63 153t153 63q55 0 101-24.5t75-65.5q2 13 3 26.5t1 27.5q0 150-105 255T480-120Z" />
                        </svg>
                        <svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 -960 960 960" width="20px"
                            fill="currentColor" class="theme-icon theme-icon-sun">
                            <path
                                d="M480-280q-83 0-141.5-58.5T280-480q0-83 58.5-141.5T480-680q83 0 141.5 58.5T680-480q0 83-58.5 141.5T480-280ZM200-440H40v-80h160v80Zm720 0H760v-80h160v80ZM440-760v-160h80v160h-80Zm0 720v-160h80v160h-80ZM256-650l-101-97 57-59 96 100-52 56Zm492 496-97-101 53-55 101 97-57 59Zm-98-550 97-101 59 57-100 96-56-52ZM154-212l101-97 55 53-97 101-59-57Z" />
                        </svg>
                        Dark Mode
                    </span>
                    <label class="theme-switch" for="theme-toggle">
                        <input type="checkbox" id="theme-toggle" aria-label="Toggle dark mode">
                        <span class="theme-slider"></span>
                    </label>
                </div>
                <button class="menu-item danger" id="logoutBtn" role="menuitem"
                    onclick="location.href='{% url 'logout_view' %}';">
                    <span><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
                            fill="#ef4444">
                            <path
                                d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h280v80H200v560h280v80H200Zm440-160-55-58 102-102H360v-80h327L585-622l55-58 200 200-200 200Z" />
                        </svg></span>
                    Logout
                </button>
            </div>
        </div>

    </div>
</header>
