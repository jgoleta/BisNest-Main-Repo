{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Product | BisNest</title>
  <link rel="stylesheet" href="{% static 'css/centralStyle.css' %}">
  <link rel="stylesheet" href="{% static 'css/productStyle.css' %}">
  <link rel="stylesheet" href="{% static 'css/centralDarkStyle.css' %}">
  <script src="{% static 'js/darkMode.js' %}" defer></script>
  <script src="{% static 'js/sidebar.js' %}" defer></script>
  <script src="{% static 'js/product.js' %}" defer></script>
</head>

<body>

  {% include 'sidebar.html' %}

  <main class="main-content">

    {% include 'header.html' with page="Product Management" %}

    <div class="container">
      <div class="search-bar">
        <input type="text" id="searchInput" placeholder="Search Product Name:" onkeyup="searchCustomer()">
        <div class="button-container">
          <button id="add-product-btn" class="toggle-form-button">+ New</button>
        </div>
      </div>

      <div id="product-list">
        {% if products %}
        {% for product in products %}
        {% if forloop.counter0|divisibleby:6 %}
        <div class="product-display">
          {% endif %}

          <button class="product-button-style" data-id="{{ product.product_id }}" data-name="{{ product.name }}"
            data-price="{{ product.price }}" data-stock="{{ product.stock }}"
            data-image="{% if product.image %}{{ product.image.url }}{% endif %}">
            <p class="product-price-label">₱{{ product.price|floatformat:2 }}</p>
            <p class="product-price-name">{{ product.name }}</p>
          </button>

          {% if forloop.counter0|add:1|divisibleby:6 or forloop.last %}
        </div>
        {% endif %}
        {% endfor %}
        {% else %}
        <p>No products available.</p>
        {% endif %}
      </div>

      <!-- Add Product Modal -->
      <div id="add-product-modal" class="modal" role="dialog" aria-modal="true">
        <div class="modal-content">
          <span class="close-add-modal close-button">&times;</span>
          <h2>Add Product</h2>
          <div class="modal-divider"></div>
          <form id="product-form" method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="form-row">
              <div class="form-group">
                <label for="{{ form.name.id_for_label }}">Product Name:</label>
                {{ form.name }}
              </div>
              <div class="form-group">
                <label for="{{ form.stock.id_for_label }}">Stock:</label>
                {{ form.stock }}
              </div>
              <div class="form-group">
                <label for="{{ form.price.id_for_label }}">Price:</label>
                {{ form.price }}
              </div>
            </div>
            <div class="modal-actions">
              <button type="submit" class="submit-button">Submit</button>
            </div>
          </form>
        </div>
      </div>

      <div id="product-modal" class="modal" role="dialog" aria-modal="true">
        <div class="modal-content">
          <span class="close-button" id="close-edit-modal">&times;</span>
          <h2 id="modal-product-name">Product Name</h2>
          <div class="modal-divider"></div>
          <p><strong>ID:</strong> <span id="modal-product-id"></span></p>

          <div class="form-group">
            <label for="modal-product-name-input" class="modal-label">Name:</label>
            <input type="text" id="modal-product-name-input">
          </div>
          <div class="form-group">
            <label for="modal-product-stock" class="modal-label">Stock:</label>
            <input type="number" id="modal-product-stock" min="0">
          </div>
          <div class="form-group">
            <label for="modal-product-price" class="modal-label">Price (₱):</label>
            <input type="number" id="modal-product-price" min="0" step="0.01">
          </div>

          <div class="modal-actions">
            <button id="save-price-btn" class="submit-button">Save</button>
            <button id="delete-modal-btn" class="remove-button">Remove</button>
          </div>
        </div>
      </div>

      <!-- Notification -->
      <div id="notification" class="notification"></div>
    </div>
  </main>

</body>

</html>