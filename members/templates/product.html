{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Product | BisNest</title>
  <link rel="stylesheet" href="{% static 'css/centralStyle.css' %}">
  <link rel="stylesheet" href="{% static 'css/productStyle.css' %}">
  <link rel="stylesheet" href="{% static 'css/centralDarkStyle.css' %}">
  <script src="{% static 'js/darkMode.js' %}" defer></script>
  <script src="{% static 'js/sidebar.js' %}" defer></script>
  <script src="{% static 'js/product.js' %}" defer></script>
</head>

<body>
  
  {% include 'sidebar.html' %}

  <main class="main-content">

    {% include 'header.html' with page="Product Management" %}

    <div class="container">
      <div style="display: flex; justify-content: flex-end; margin-bottom: 20px; gap: 10px;">
        <button id="add-product-btn" class="toggle-form-button">+ New</button>
      </div>
      <div id="product-list"
        style="display: flex; flex-direction: column; align-items: center; gap: 2rem; margin-top: 30px;">
        {% if products %}
        {% for product in products %}
        {% if forloop.counter0|divisibleby:6 %}
        <div style="display:flex; gap:2rem; margin-bottom:2rem;">
          {% endif %}

          <button class="product-button-style" data-id="{{ product.product_id }}" data-name="{{ product.name }}"
            data-price="{{ product.price }}" data-stock="{{ product.stock }}"
            data-image="{% if product.image %}{{ product.image.url }}{% endif %}">
            <img src="{% if product.image %}{{ product.image.url }}{% else %}{{ '' }}{% endif %}" class="parts-logo"
              alt="{{ product.name }}">
            <p class="product-price-label">₱{{ product.price|floatformat:2 }}</p>
            <p class="product-price-name">{{ product.name }}</p>
          </button>

          {% if forloop.counter0|add:1|divisibleby:6 or forloop.last %}
        </div>
        {% endif %}
        {% endfor %}
        {% else %}
        <p>No products available.</p>
        {% endif %}
      </div>

      <!-- Add Product Modal -->
      <div id="add-product-modal" class="modal" role="dialog" aria-modal="true">
        <div class="modal-content">
          <span class="close-add-modal close-button">&times;</span>
          <h2>Add Product</h2>
          <div class="modal-divider"></div>
          <form id="add-product-form" method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="modal-label">
              <label for="add-product-name">Product Name:</label>
              {{ form.name }}
            </div>
            <div class="modal-label">
              <label for="add-product-stock">Stock:</label>
              {{ form.stock }}
            </div>
            <div class="modal-label">
              <label for="add-product-price">Price (₱):</label>
              {{ form.price }}
            </div>
            <div class="modal-label">
              <label for="add-product-image">Image:</label>
              {{ form.image }}
            </div>
            <button type="submit" class="submit-button"
              style="margin-top: 18px; min-width: 120px; font-size: 1.1rem; float: right;">Add</button>
          </form>
        </div>
      </div>

      <div id="product-modal" class="modal" role="dialog" aria-modal="true">
        <div class="modal-content">
          <span class="close-button" id="close-edit-modal">&times;</span>
          <h2 id="modal-product-name">Product Name</h2>
          <div class="modal-divider"></div>
          <p><strong>ID:</strong> <span id="modal-product-id"></span></p>
          <div style="margin-bottom: 18px;">
            <label for="modal-product-name-input"><strong>Name:</strong></label>
            <input type="text" id="modal-product-name-input"
              style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #bbb;">
          </div>
          <div style="margin-bottom: 18px;">
            <label for="modal-product-stock"><strong>Stock:</strong></label>
            <input type="number" id="modal-product-stock" min="0"
              style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #bbb;">
          </div>
          <div style="margin-bottom: 18px;">
            <label for="modal-product-price"><strong>Price (₱):</strong></label>
            <input type="number" id="modal-product-price" min="0" step="0.01"
              style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #bbb;">
          </div>
          <div class="modal-actions">
            <button id="save-price-btn" class="submit-button">Save Changes</button>
            <button id="delete-modal-btn" class="delete-modal-btn">Delete</button>
          </div>
        </div>
      </div>
    </div>
  </main>

</body>

</html>